#!/bin/bash

# Raspberry Pi OS Bash Functions
# Functions specific to Raspberry Pi OS

# Source parent debian functions first
# Get the directory where this file actually lives (resolves symlinks)
BASH_FUNCTIONS_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"

if [ -f "${BASH_FUNCTIONS_DIR}/../debian/bash_functions" ]; then
    source "${BASH_FUNCTIONS_DIR}/../debian/bash_functions"
fi

# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

# Raspberry Pi specific functions
pi_temp() {
    vcgencmd measure_temp
}

pi_throttle() {
    vcgencmd get_throttled
}

pi_version() {
    cat /proc/device-tree/model
}

pi_info() {
    echo "=== Raspberry Pi Information ==="
    pi_version
    echo "Temperature: $(pi_temp)"
    echo "Throttle Status: $(pi_throttle)"
    echo "Uptime: $(uptime)"
    echo "Memory: $(free -h | grep Mem)"
    echo "Disk Usage: $(df -h / | tail -1)"
}

# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

# Server monitoring functions
server_status() {
    echo "=== Server Status ==="
    echo "Uptime: $(uptime)"
    echo "Load Average: $(cat /proc/loadavg)"
    echo "Memory Usage:"
    free -h
    echo "Disk Usage:"
    df -h
    echo "Network Connections:"
    ss -tuln
}

# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

# Git functions
git_current_branch() {
    git rev-parse --abbrev-ref HEAD 2> /dev/null
}

git_log_oneline() {
    git log --oneline -10
}

git_status_short() {
    git status --short --branch
}

# - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
